Q.1. Create a database for the Hospital Management System based on your ER. Create appropriate tables & relationships.

CREATE DATABASE HOSPITAL;
SHOW DATABASES;
USE HOSPITAL;


CREATE TABLE DEPARTMENTS(
	DEPARTMENT_ID INT           NOT NULL,
	DEPARTMENT_NAME VARCHAR(40) NOT NULL,
	PRIMARY KEY(DEPARTMENT_ID)
);

CREATE TABLE DOCTORS(
	DOCTOR_ID INT              NOT NULL,
	DOCTOR_NAME VARCHAR(40)    NOT NULL,
	DOCTOR_ADDRESS VARCHAR(40),
	DOCTOR_SALARY INT          NOT NULL,
	DEPARTMENT_ID INT          NOT NULL,
	PRIMARY KEY (DOCTOR_ID),
	FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS (DEPARTMENT_ID)
);

CREATE TABLE PATIENTS(
	PATIENT_ID INT            NOT NULL,
	PATIENT_NAME VARCHAR(40)  NOT NULL,
	PATIENT_CITY VARCHAR(40),
	PATIENT_CONTACT CHAR(10)  UNIQUE,
	ADMIT_DATE DATE           NOT NULL,
	DISCHARGE_DATE DATE,
	DOCTOR_ID INT             NOT NULL,
	PRIMARY KEY(PATIENT_ID),
	FOREIGN KEY (DOCTOR_ID) REFERENCES DOCTORS (DOCTOR_ID)
);

INSERT INTO DEPARTMENTS VALUES(1, 'CARDIOLOGY');
INSERT INTO DEPARTMENTS VALUES(2, 'PHYSIOTHERAPY');
INSERT INTO DEPARTMENTS VALUES(3, 'MATERNITY');


INSERT INTO DOCTORS VALUES(1001, 'YATIN',  'DELHI' , 100000 , 2);
INSERT INTO DOCTORS VALUES(1002, 'VAIBHAV', NULL, 50000 , 3);
INSERT INTO DOCTORS VALUES(1003, 'HRISHABH', 'MUMBAI' , 150000 , 2);
INSERT INTO DOCTORS VALUES(1004, 'SHIKHAR', NULL, 200000 , 1);
INSERT INTO DOCTORS VALUES(1005, 'DIVYANSHU', 'BANGALORE' , 75000 , 3)


INSERT INTO PATIENTS VALUES(2001, 'VIKAS', 'DELHI', NULL , '2020-10-22', '2020-10-23' , 1001);
INSERT INTO PATIENTS VALUES(2002, 'SUMERA', NULL , '959999990', '2020-10-21', '2020-10-22', 1004);
INSERT INTO PATIENTS VALUES(2003, 'SUMERA', NULL , '959999923', '2020-10-21', '2020-10-22', 1002);
INSERT INTO PATIENTS VALUES(2004, 'SIDRA', 'GURGAON' , NULL , '2020-10-19', NULL , 1003);
INSERT INTO PATIENTS VALUES(2005, 'ASJAD', NULL, '999099981', '2020-10-18', '2020-10-20', 1001);
INSERT INTO PATIENTS VALUES(2006, 'ASHUTOSH', NULL, '999989691', '2020-10-17', '2020-10-18', 1002);
INSERT INTO PATIENTS VALUES(2007, 'PRANJAL', 'GHAZIABAD', NULL , '2020-10-16', NULL , 1003);
INSERT INTO PATIENTS VALUES(2008, 'HIMANSHU', NULL , '999987991' , '2020-10-15', '2020-10-16' , 1004);
INSERT INTO PATIENTS VALUES(2009, 'RISHABH', 'AGRA' , NULL , '2020-10-14', '2020-10-15' , 1005);
INSERT INTO PATIENTS VALUES(2010, 'SANKET', 'BIHAR' , NULL , '2020-10-13', NULL , 1001);
INSERT INTO PATIENTS VALUES(2011, 'BHAVYA', NULL , '999989951' , '2020-10-12', '2020-10-13' , 1002);

SELECT * FROM DEPARTMENTS;
SELECT * FROM DOCTORS;
SELECT * FROM PATIENTS;



Q.2. Design a query to provide a list of doctors, which department they belong to and patients treated by them (if any).


SELECT T.DOCTOR_ID, T.DOCTOR_NAME, T.DEPARTMENT_NAME, PATIENT_NAME 
FROM (SELECT D.DOCTOR_ID, D.DOCTOR_NAME, DP.DEPARTMENT_NAME 
	FROM DOCTORS AS D 
	INNER JOIN DEPARTMENTS AS DP 
	ON D.DEPARTMENT_ID = DP.DEPARTMENT_ID)
AS T 
LEFT JOIN PATIENTS 
ON T.DOCTOR_ID = PATIENTS.DOCTOR_ID;



Q.3. Query to provide the count of patients discharged per day in the last week.


SELECT DISCHARGE_DATE, COUNT(PATIENT_ID) 
FROM PATIENTS 
GROUP BY DISCHARGE_DATE 
HAVING DATE(DISCHARGE_DATE) BETWEEN '2020-10-16' AND '2020-10-22';

